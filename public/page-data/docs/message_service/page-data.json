{"componentChunkName":"component---src-templates-doc-js","path":"/docs/message_service","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Message Service"},"html":"<h1 id=\"消息服务\" style=\"position:relative;\"><a href=\"#%E6%B6%88%E6%81%AF%E6%9C%8D%E5%8A%A1\" aria-label=\"消息服务 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>消息服务</h1>\n<p>消息服务允许你向用户弹出提示消息、对话框和进度信息，你可以获得 <code class=\"language-text\">MessageService</code> 的注入，并调用 <code class=\"language-text\">info</code>、<code class=\"language-text\">warn</code> 或 <code class=\"language-text\">error</code> 来展示消息（见下面的代码例子）。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">inject</span></span><span class=\"token punctuation\">(</span>MessageService<span class=\"token punctuation\">)</span> <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> messageService<span class=\"token operator\">:</span> MessageService\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>messageService<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Hello World!'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>默认情况下，Theia 会在右下角以浮窗的形式显示消息，下面是不同消息类型（info, warn and error）的截图。注意，你可以通过实现自定义的 <code class=\"language-text\">MessageClient</code> 来轻松地控制 Theia 不同行为的消息。</p>\n<p>Info</p>\n<img src=\"/message-service-info.png\" alt=\"Message Service - info\" style=\"max-width: 525px\">\n<p>Warn</p>\n<img src=\"/message-service-warn.png\" alt=\"Message Service - warning\" style=\"max-width: 525px\">\n<p>Error</p>\n<img src=\"/message-service-error.png\" alt=\"Message Service - error\" style=\"max-width: 525px\">\n<p>默认情况下，提示会一直展示，直到用户关闭它们，也可以选择定义的时间，超时后消息自动关闭。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>messageService<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Say Hello with timeout'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span>timeout<span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>另外，还可以添加用户可执行的选项操作，如果用户选择了某个操作，执行了一个动作，消息将展示用户所选的操作。</p>\n<p>在下面的例子中，我们提供了两个动作 “Say Hello again!” 和 “Cancel”，我们对 “Say Hello again!” 这个操作的是发布另一条消息，“Cancel” 则是忽略。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">inject</span></span><span class=\"token punctuation\">(</span>MessageService<span class=\"token punctuation\">)</span> <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> messageService<span class=\"token operator\">:</span> MessageService\n\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>messageService\n <span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello World!\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Say Hello again!\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Cancel\"</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>action <span class=\"token operator\">===</span> <span class=\"token string\">\"Say Hello again!\"</span><span class=\"token punctuation\">)</span>\n     <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>messageService<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello again!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>警示通知像这样：</p>\n<img src=\"/message-service-user-action.png\" alt=\"Message Service - user action\" style=\"max-width: 525px\">\n<p>当用户选择 “Say Hello again” 时，将显示另一个警示通知：</p>\n<img src=\"/message-service-hello-again.png\" alt=\"Message Service - after user action\" style=\"max-width: 525px\">\n<h2 id=\"进度提示\" style=\"position:relative;\"><a href=\"#%E8%BF%9B%E5%BA%A6%E6%8F%90%E7%A4%BA\" aria-label=\"进度提示 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>进度提示</h2>\n<p>消息服务也允许提示正在进行的操作的进度，你可以逐步更新进度条和消息，并让通知保持可见，直到操作完成。下面的例子打开了一个进度条，并在完成前三次更新状态。更多信息请参考 <a href=\"https://eclipse-theia.github.io/theia/docs/next/classes/core.messageservice-1.html#showprogress\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">TypeDoc of <code class=\"language-text\">MessageService</code></a>。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>messageService\n <span class=\"token punctuation\">.</span><span class=\"token function\">showProgress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n   text<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Doing something</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>progress<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n   <span class=\"token comment\">// Do something</span>\n   progress<span class=\"token punctuation\">.</span><span class=\"token function\">report</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n     message<span class=\"token operator\">:</span> <span class=\"token string\">\"First step completed\"</span><span class=\"token punctuation\">,</span>\n     work<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> done<span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> total<span class=\"token operator\">:</span> <span class=\"token number\">100</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token comment\">// Do something</span>\n   progress<span class=\"token punctuation\">.</span><span class=\"token function\">report</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n     message<span class=\"token operator\">:</span> <span class=\"token string\">\"Next step completed\"</span><span class=\"token punctuation\">,</span>\n     work<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> done<span class=\"token operator\">:</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> total<span class=\"token operator\">:</span> <span class=\"token number\">100</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token comment\">// Do something</span>\n   progress<span class=\"token punctuation\">.</span><span class=\"token function\">report</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n     message<span class=\"token operator\">:</span> <span class=\"token string\">\"Complete\"</span><span class=\"token punctuation\">,</span>\n     work<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> done<span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> total<span class=\"token operator\">:</span> <span class=\"token number\">100</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   progress<span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>需注意，<code class=\"language-text\">progress.cancel</code> 也会表示进度任务已经完成，上面的例子运行效果为：</p>\n<img src=\"/message-service-progress-reporting.gif\" alt=\"Message Service - progress reporting\" style=\"max-width: 525px\">","fields":{"slug":"message_service"}}},"pageContext":{"slug":"message_service"}},"staticQueryHashes":["2468095761"]}